<!-- Extends the layout from /views/layout.html -->
{% extends 'layout.html' %}
<!-- 
  In /views/layout.html you can:
    - edit the header and footer 
    - add custom CSS and JavaScript
-->

<!-- Set the page title -->
{% block pageTitle %}
Content page example - NHS.UK prototype kit
{% endblock %}

<!-- For adding a breadcrumb -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/breadcrumbs -->
{% block beforeContent %}

<div class="nhsuk-secondary-navigation">
   <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-full">
         <div class="nhsuk-secondary-navigation__container">
            <div class="nhsuk-secondary-navigation__nav" style="width: 100%">
               <nav class="nhsuk-secondary-navigation" aria-label="Primary navigation">
                  <ul class="nhsuk-secondary-navigation__list">
                     <li class="nhsuk-secondary-navigation__item">
                        <br><br>
                     </li>
                  </ul>
               </nav>
            </div>
         </div>
      </div>
   </div>
</div>
{% endblock %}

<!-- For adding a back link -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/back-link -->
{% block outerContent %}
{% endblock %}

<!-- For adding page content -->
<!-- Page layout code can be found at https://service-manual.nhs.uk/design-system/styles/layout -->
{% block content %}


<div class="nhsuk-grid-row">
   <div class="nhsuk-grid-column-one-half">
      <h1 class="nhsuk-heading-l">Review your penalty charge</h1>

      <div class="nhsuk-warning-callout">
         <h3 class="nhsuk-warning-callout__label">
            <span role="text">
               Important:
            </span>
         </h3>
         <p>All information must be read out to the patient.</p>
      </div>

      {% set errorMessageText = 'Select that you confirm and accept your penalty charge' %}

      {% if data.showErrors === 'true' %}
      {{ errorSummary({
      titleText: 'There is a problem',
      errorList: [
      {
      text: errorMessageText,
      href: '#acceptPCNDeclarationB-1'
      }
      ]
      }) }}
      {% endif %}


      <div class="nhsuk-card">
         <div class="nhsuk-card__content">


            <h3 class="nhsuk-heading-m">Penalty Charge Notice amount</h3>

            {% if data.settings[version].type === 'decs' %}

            <!-- DECS -->
            {% set summaryListRows = [
            {
            key: { text: 'Dental treatment charges' },
            value: { text: '£75.30' }
            },
            {
            key: { text: 'Penalty charge' },
            value: { text: '£50.00' }
            },
            {
            key: { text: 'Total amount to pay' },
            value: { html: '<strong>£125.30</strong>' }
            }]%}

            {{ summaryList({
            rows: summaryListRows
            }) }}

            <p class="nhsuk-heading-l nhsuk-u-margin-bottom-0">Amount to pay: £125.30</p>

            {% else %}

            <!-- PECS -->
            {% set summaryListRows = [
            {
            key: { text: 'Prescription charges' },
            value: { text: '£9.90' }
            },
            {
            key: { text: 'Penalty charge' },
            value: { text: '£50.00' }
            },
            {
            key: { text: 'Total amount to pay' },
            value: { html: '<strong>£59.90</strong>' }
            }]%}

            {{ summaryList({
            rows: summaryListRows
            }) }}

            <p class="nhsuk-heading-l nhsuk-u-margin-bottom-0">Amount to pay: £59.90</p>

            {% endif%}



            <form action="pcn-accepted-EXPEDITE" method="post" novalidate>


               <h2 class="nhsuk-heading-m" style="margin-top:25px;">What you can do next</h2>

               <h3 class="nhsuk-heading-s">Do not accept the penalty charge</h3>

               <p>You still have 28 days to confirm you were entitled to free NHS prescriptions (by 6 January 2026). If
                  you
                  can confirm this, it will resolve the issue and stop you getting a penalty charge.</p>
               <p>If you do not want to accept the penalty charge today you can still use this service to confirm you
                  were
                  entitled. You'll need to check the details on your enquiry letter first.</p>

               <!-- {{ actionLink({
                        href: 'enquiry-letter-details',
                        text: 'Go back to check the details on your enquiry letter'
                        }) }} -->

               <p>If you do not confirm you were entitled to {{ freeStuff }} we will send a Penalty Charge Notice.</p>





               <h3 class="nhsuk-heading-s">Accept the penalty charge</h3>

               <!-- {{ warningCallout({
                           heading: 'Important information',
                           classes: 'smaller-heading',
                           html: '<p>If you accept your penalty charge today, you must make a payment or set up a Direct Debit within 31
                              days.</p>
                              <p>If you do not, an extra surcharge of up to £50 may be added to these charges.</p>'
                              }) }} -->

               <p>If you accept your penalty charge today, you must make a payment or set up a Direct Debit within 31
                  days.</p>
               <p>If you do not, an extra surcharge of up to £50 may be added to these charges.</p>

               <p>If you accept the penalty charge today you confirm that you:</p>
               <ul class="nhsuk-list nhsuk-list--bullet">
                  <li>were not entitled to free NHS Prescriptions</li>
                  <li>understand that you must make a payment or set up a Direct Debit within 31 days</li>
               </ul>

               {% set errorMessage = '' %}
               {% if data.showErrors === 'true' %}
               {% set errorMessage = { text: errorMessageText } %}
               {% endif %}

               {{ checkboxes({
               idPrefix: 'acceptPCNDeclarationB',
               name: 'acceptPCNDeclarationB',
               id: 'acceptPCNDeclarationB',
               errorMessage: errorMessage,
               fieldset: {
               legend: {
               text: 'Tick the box if you accept the following statements',
               isPageHeading: false,
               classes: 'nhsuk-u-visually-hidden'
               }
               },
               items: [
               {
               value: 'acceptCharge',
               html: 'I confirm and accept my penalty charge'
               }
               ]
               }) }}


               {% if data.showEmailInput === 'true' %}

               <hr class="nhsuk-section-break nhsuk-section-break--visible nhsuk-section-break--m" />

               {{ input({
               label: {
               text: 'What is your email address? (optional)',
               classes: 'nhsuk-label--s'
               },
               hint: {
               text: 'We will use this to send you notifications and reminders about your case.'
               },
               inputmode: 'email',
               id: 'emailAddress',
               name: 'emailAddress',
               value: data.emailAddress,
               attributes: {
               autocomplete: 'none'
               },
               classes: 'nhsuk-input--width-20'
               }) }}

               {{ input({
               label: {
               text: 'Confirm email',
               classes: 'nhsuk-label--s'
               },
               id: 'confirmEmailAddress',
               inputmode: 'email',
               attributes: {
               autocomplete: 'none'
               },
               classes: 'nhsuk-input--width-20'
               }) }}


               <style>
                  .nhsuk-hidden {
                     display: none;
                  }
               </style>

               <script>

                  const ConfirmEmail = (function () {

                     function _init() {

                        const email = document.querySelector('#emailAddress');
                        const emailConfirm = document.querySelector('#confirmEmailAddress');

                        emailConfirm.parentElement.classList.add('nhsuk-hidden');

                        email.addEventListener('change', function () {

                           if (email.value.trim() !== '') {

                              // Value exists
                              emailConfirm.value = '';
                              emailConfirm.parentElement.classList.remove('nhsuk-hidden');
                              emailConfirm.focus();

                           } else {

                              // No value
                              emailConfirm.value = '';
                              emailConfirm.parentElement.classList.add('nhsuk-hidden');

                           }

                        });


                     };

                     return {
                        init: _init
                     }
                  })();

                  document.addEventListener('DOMContentLoaded', function () {
                     ConfirmEmail.init();
                  });

               </script>


               <hr class="nhsuk-section-break nhsuk-section-break--m" />

               {% endif %}



               {{ button({
               text: 'Accept penalty charge'
               }) }}

            </form>



            <p class="nhsuk-body nhsuk-u-margin-top-6"><a href="respond-to-your-letter" class="nhsuk-link">Cancel</a>
            </p>


         </div>
      </div>

   </div>


   <div class="nhsuk-grid-column-one-half">
      <div class="border-box" id="rightHandSide">
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-full">
               <h1 class="nhsuk-heading-m">PCN 06183129565: Open</h1>
               <p class="nhsuk-heading-m"><a href="view-prescription"> View prescription</a></p>
            </div>
            <!--<h1 class="nhsuk-heading-m">Direct Debit</h1>-->
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Prescription</h2>
               <p>£9.90</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Enquiry sent</h2>
               <p>15/07/2025</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Items</h2>
               <p>3</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Penalty</h2>
               <p>£50.00</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">PCN sent</h2>
               <p>Not sent</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Prescribed date</h2>
               <p>05/05/25</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Surcharge</h2>
               <p>Not sent</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Surcharge sent</h2>
               <p>Not sent</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Dispensed month end date</h2>
               <p>05/05/25</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Requested</h2>
               <p>£176.40</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Respond by</h2>
               <p>07/11/25</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Exemption</h2>
               <p>(M) Has valid NHS Tax Credit Exemption Certificate</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Paid</h2>
               <p>N/A</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">DWP checked</h2>
               <p>Yes</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Source</h2>
               <p>Electronic</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Balance due</h2>
               <p>N/A</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Dispenser</h2>
               <p><a href="dispenser-details">FMMMM</a></p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Evidence not seen?</h2>
               <p>No</p>
            </div>
         </div>

         <div class="scrollable-panel">
            <div class="nhsuk-grid-row">
               <div class="nhsuk-grid-column-full">
                  <div class="container">

                     {% set notesContent %}
                     {{ table({
                     responsive: false,
                     panel: false,
                     firstCellIsHeader: false,
                     head: [
                     {
                     text: "Date"
                     },
                     {
                     text: "Agent"
                     },
                     {
                     text: "Comments"
                     }
                     ]
                     }) }}
                     {% endset -%} {% set transactionsContent %}
                     {{ table({
                     responsive: false,
                     panel: false,
                     firstCellIsHeader: false,
                     head: [
                     {
                     text: "Date"
                     },
                     {
                     text: "User"
                     },
                     {
                     text: "Amount"
                     },
                     {
                     text: "For"
                     },
                     {
                     text: "Type"
                     },
                     {
                     text: "Action"
                     }
                     ]
                     }) }}
                     {% endset -%} {% set auditContent %}
                     {{ table({
                     responsive: false,
                     panel: false,
                     firstCellIsHeader: false,
                     head: [
                     {
                     text: "Date"
                     },
                     {
                     text: "Agent"
                     },
                     {
                     text: "Comments"
                     }
                     ]
                     }) }}
                     {% endset -%}
                     {{ tabs({
                     items: [
                     {
                     label: "Notes",
                     id: "notes",
                     panel: {
                     html: notesContent
                     }
                     },
                     {
                     label: "Transactions",
                     id: "transactions",
                     panel: {
                     html: transactionsContent
                     }
                     },
                     {
                     label: "Audit history",
                     id: "audit-history",
                     panel: {
                     html: auditContent
                     }
                     }
                     ]
                     }) }}
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

<script>
   var maxLength = 375;
   $('textarea').keyup(function () {
      var length = $(this).val().length;
      var length = maxLength - length;
      $('#chars').text(length);
   });
</script>

{% endblock %}