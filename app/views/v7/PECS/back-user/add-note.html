<!-- Extends the layout from /views/layout.html -->
{% extends 'layout.html' %}
<!-- 
  In /views/layout.html you can:
    - edit the header and footer 
    - add custom CSS and JavaScript
-->

<!-- Set the page title -->
{% block pageTitle %}
Add note
{% endblock %}

<!-- For adding a breadcrumb -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/breadcrumbs -->
{% block beforeContent %}

<div class="nhsuk-secondary-navigation">
   <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-full">
         <div class="nhsuk-secondary-navigation__container">
            <div class="nhsuk-secondary-navigation__nav" style="width: 100%">
               <nav class="nhsuk-secondary-navigation" aria-label="Primary navigation">
                  <ul class="nhsuk-secondary-navigation__list">
                     <li class="nhsuk-secondary-navigation__item">
                        <br><br>
                     </li>
                  </ul>
               </nav>
            </div>
         </div>
      </div>
   </div>
</div>
{% endblock %}

<!-- For adding a back link -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/back-link -->
{% block outerContent %}
{% endblock %}

<!-- For adding page content -->
<!-- Page layout code can be found at https://service-manual.nhs.uk/design-system/styles/layout -->
{% block content %}

<div class="nhsuk-grid-row">
   <div class="nhsuk-grid-column-one-half">

      <h1 class="nhsuk-u-margin-bottom-4">
         Create note
      </h1>

      <form action="view-pcn" method="POST" id="form">
         {{ select({
         id: "contact-channel",
         name: "contact-channel",
         label: {
         html: '<label class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Contact Channel</label>'
         },
         items: [
         {
         value: call,
         text: "Call"
         },
         {
         value: "email",
         text: "Email"
         },
         {
         value: letter,
         text: "Letter",
         selected: true
         },
         {
         value: webchat,
         text: "Webchat"
         },
         {
         value: admin,
         text: "Admin"
         }
         ]
         }) }}

         <!-- Hidden field for email address -->
         <div id="emailField" class="nhsuk-form-group" style="display: none;">
            {{ input({
            label: {
            html: '<label class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Email reference</label>'
            },
            id: "email-ref",
            name: "email-ref",
            classes: "nhsuk-input--width-20"
            }) }}
         </div>

         <script>
            // Get references
            const select = document.getElementById('contact-channel');
            const emailField = document.getElementById('emailField');

            // Listen for changes
            select.addEventListener('change', function () {
               if (this.value === 'email') {
                  emailField.style.display = 'block';
               } else {
                  emailField.style.display = 'none';
               }
            });

            // Run once on load (in case of preselected option)
            if (select.value === 'email') {
               emailField.style.display = 'block';
            }
         </script>
         <div class="nhsuk-form-group">
            <label class="nhsuk-label" for="example">
               Notes
            </label>
            <textarea class="nhsuk-textarea" id="message" name="message" rows="8" style="font-size:19px;"
               onkeyup="countChars(this);">This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one character too many. This is one chara</textarea>
            <p class="nhsuk-hint" id="charNum">You have 2000 characters remaining</p>
         </div>

         <div class="nhsuk-form-group">
            <div class="nhsuk-checkboxes">

               <div class="nhsuk-checkboxes__item">
                  <input class="nhsuk-checkboxes__input" id="example-1" name="example" type="checkbox" value="email">
                  <label class="nhsuk-label nhsuk-checkboxes__label" for="example-1">
                     Apply to open cases only
                  </label>
               </div>

               <div class="nhsuk-checkboxes__item">
                  <input class="nhsuk-checkboxes__input" id="example-2" name="example" type="checkbox" value="phone">
                  <label class="nhsuk-label nhsuk-checkboxes__label" for="example-2">
                     Apply to all cases
                  </label>
               </div>
            </div>
         </div>
         <button class="nhsuk-button" id="button" type="submit">Submit</button>
      </form>

      <p><a href="css-pcn-view">Cancel</a></p>
   </div>

   <div class="nhsuk-grid-column-one-half">
      <div class="border-box" id="rightHandSide">
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-full">
               <h1 class="nhsuk-heading-m">PCN 06183129565: Open</h1>

            </div>
            <!--<h1 class="nhsuk-heading-m">Direct Debit</h1>-->
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Prescription</h2>
               <p>£26.40</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Enquiry sent</h2>
               <p>Not sent</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Items</h2>
               <p>3</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Penalty</h2>
               <p>£100.00</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">PCN sent</h2>
               <p>10/09/18</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Prescribed date</h2>
               <p>29/05/18</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Surcharge</h2>
               <p>£50.00</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Surcharge sent</h2>
               <p>10/10/18</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Dispensed month end date</h2>
               <p>30/06/18</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Requested</h2>
               <p>£176.40</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Respond by</h2>
               <p>07/11/18</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Exemption</h2>
               <p>(M) Has valid NHS Tax Credit Exemption Certificate</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Paid</h2>
               <p>£10.00</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">DWP checked</h2>
               <p>Yes</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Source</h2>
               <p>Electronic</p>
            </div>
         </div>
         <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Balance due</h2>
               <p>£166.40</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Dispenser</h2>
               <p>FMMMM</p>
            </div>
            <div class="nhsuk-grid-column-one-third">
               <h2 class="nhsuk-heading-xs nhsuk-u-margin-bottom-0">Evidence not seen?</h2>
               <p>No</p>
            </div>
         </div>

         <div class="scrollable-panel">
            <div class="nhsuk-grid-row">
               <div class="nhsuk-grid-column-full">
                  <div class="container">

                     {% set notesContent %}
                     {{ table({
                     responsive: false,
                     panel: false,
                     firstCellIsHeader: false,
                     head: [
                     {
                     text: "Date"
                     },
                     {
                     text: "Agent"
                     },
                     {
                     text: "Comments"
                     }
                     ],
                     rows: [
                     [
                     {
                     text: "30/09/2025 14:23"
                     },
                     {
                     text: "TIM"
                     },
                     {
                     text: "Refund in progress"
                     }
                     ],
                     [
                     {
                     text: "30/09/2025 14:15"
                     },
                     {
                     text: "SYSTEM"
                     },
                     {
                     text: "REFUND REQUESTED"
                     }
                     ],
                     [
                     {
                     text: "08/09/25 11:12"
                     },
                     {
                     text: "TIM"
                     },
                     {
                     text: "Cust told to pay half to avoid surcharge. Cust non compliant, demanded manager. Call
                     escalated."
                     }
                     ],
                     [
                     {
                     text: "03/09/25 12:32"
                     },
                     {
                     text: "JOANNE"
                     },
                     {
                     text: "Info repeated as above. Cust paid half, agreed to pay next half by 27/09/25"
                     }
                     ],
                     [
                     {
                     text: "27/08/25 15:18"
                     },
                     {
                     text: "TIM"
                     },
                     {
                     text: "Cust told to pay half to avoid surcharge. Cust non compliant, demanded manager. Call
                     escalated."
                     }
                     ],
                     [
                     {
                     text: "21/08/25 12:16"
                     },
                     {
                     text: "JOANNE"
                     },
                     {
                     text: "Info repeated as above. Cust paid half, agreed to pay next half by 27/09/25"
                     }
                     ],
                     [
                     {
                     text: "19/08/25 14:02"
                     },
                     {
                     text: "TIM"
                     },
                     {
                     text: "Cust told to pay half to avoid surcharge. Cust non compliant, demanded manager. Call
                     escalated."
                     }
                     ],
                     [
                     {
                     text: "08/08/25 12:02"
                     },
                     {
                     text: "JOANNE"
                     },
                     {
                     text: "Info repeated as above. Cust paid half, agreed to pay next half by 27/09/25"
                     }
                     ]
                     ]
                     }) }}
                     {% endset -%} {% set transactionsContent %}
                     {{ table({
                     responsive: false,
                     panel: false,
                     firstCellIsHeader: false,
                     head: [
                     {
                     text: "Date"
                     },
                     {
                     text: "User"
                     },
                     {
                     text: "Amount"
                     },
                     {
                     text: "For"
                     },
                     {
                     text: "Type"
                     },
                     {
                     text: "Action"
                     }
                     ],
                     rows: [
                     [
                     {
                     text: "31/07/25 15:44"
                     },
                     {
                     text: "System"
                     },
                     {
                     text: "-£8.60"
                     },
                     {
                     text: "Adjustment"
                     },
                     {
                     text: "Direct Debit"
                     },
                     {
                     html: '<a href=#>Edit</a>'
                     }
                     ],
                     [
                     {
                     text: "30/07/25 12:24"
                     },
                     {
                     text: "System"
                     },
                     {
                     text: "£8.60"
                     },
                     {
                     text: "PCN"
                     },
                     {
                     text: "Direct Debit"
                     },
                     {
                     text: ""
                     }
                     ],
                     [
                     {
                     text: "27/07/25 11:51"
                     },
                     {
                     text: "System"
                     },
                     {
                     text: "£51.00"
                     },
                     {
                     text: "PCN"
                     },
                     {
                     text: "Cheque"
                     },
                     {
                     text: ""
                     }
                     ],
                     [
                     {
                     text: "20/07/25 10:23"
                     },
                     {
                     text: "System"
                     },
                     {
                     text: "-£51.00"
                     },
                     {
                     text: "Surcharge"
                     },
                     {
                     text: "Surcharge added"
                     },
                     {
                     html: '<a href=#>Edit</a>'
                     }
                     ],
                     [
                     {
                     text: "19/07/25 14:20"
                     },
                     {
                     text: "System"
                     },
                     {
                     text: "£58.60"
                     },
                     {
                     text: "PCN"
                     },
                     {
                     text: "Payment request"
                     },
                     {
                     text: ""
                     }
                     ]
                     ]
                     }) }}
                     {% endset -%} {% set auditContent %}
                     {{ table({
                     responsive: false,
                     panel: false,
                     firstCellIsHeader: false,
                     head: [
                     {
                     text: "Date"
                     },
                     {
                     text: "Agent"
                     },
                     {
                     text: "Comments"
                     }
                     ],
                     rows: [
                     [
                     {
                     text: "14/10/25 15:01"
                     },
                     {
                     text: "JOECA"
                     },
                     {
                     text: "Surname changed from: CARTWRIGHT, Postcode changed from: NE1 1EN"
                     }
                     ],
                     [
                     {
                     text: "14/10/25 14:59"
                     },
                     {
                     text: "JOECA"
                     },
                     {
                     text: " Address line 1 changed from: 152 BRIDGE HOUSE"
                     }
                     ],
                     [
                     {
                     text: "30/09/25 11:02"
                     },
                     {
                     text: "JOECA"
                     },
                     {
                     text: " Email changed from: JBLOGGS2@GMAIL.COM"
                     }
                     ]
                     ]
                     }) }}
                     {% endset -%}
                     {{ tabs({
                     items: [
                     {
                     label: "Notes",
                     id: "notes",
                     panel: {
                     html: notesContent
                     }
                     },
                     {
                     label: "Transactions",
                     id: "transactions",
                     panel: {
                     html: transactionsContent
                     }
                     },
                     {
                     label: "Audit history",
                     id: "audit-history",
                     panel: {
                     html: auditContent
                     }
                     }
                     ]
                     }) }}
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

<script>
   var maxLength = 375;
   $('textarea').keyup(function () {
      var length = $(this).val().length;
      var length = maxLength - length;
      $('#chars').text(length);
   });
</script>

</html>
{% endblock %}